\thispagestyle{fancy2}

\section{細胞の再生力の解明}
\label{sec:regeneration}

植物は，分裂して自身と同じ細胞を作る（自己複製する）能力と専門的な役割を獲得する（分化する）能力をもつ幹細胞が分裂を繰り返し，これらの細胞が分化することによって成長する\cite{sakamoto2022transcriptional}．この分化した細胞は通常分裂を行わないが，特定の状況下で再び幹細胞となり分裂を始め，植物によっては一細胞から個体が再生されることがある．この現象はリプログラミングと呼ばれる．

しかしながらこのリプログラミングにおいて，細胞が分裂を再開するメカニズムは未だ解明されていない．このメカニズムを解明するために注目されている技術が，single cell RNA-seq（scRNA-seq）\cite{kolodziejczyk2015technology}である．scRNA-seqでは，植物の組織から細胞を単離させ（プロトプラスト化\cite{pasternak2020single}，図\ref{fig:protoplast_and_main_system}（左）），これら各細胞に対して転写産物であるRNAを解析する．RNAを解析することで，遺伝子発現パターン，すなわち細胞がどのようなタンパク質を生成しているのかを遺伝子レベルで調べることができる\cite{xiao2012transcriptome,sakamoto2022transcriptional}．

この遺伝子発現パターンの解析では，どこの細胞がいつ，どのような遺伝子発現を行ったかが重要視される．これが明らかになれば組織の成長を制御することが可能になる．シロイヌナズナのscRNA-seq\cite{shahan2022single}では，すでに10万を超える大量の細胞を対象とした遺伝子発現の解析が行われ，根冠細胞や伸張細胞といった細胞のタイプごとの遺伝子発現解析を明らかにした．しかしこの研究においても，未だ一細胞レベルの空間分解能をもったscRNA-seqは行われていない．また細胞の特性は，隣接する細胞の特性やその位置関係に強く影響されるため，一細胞レベルの空間分解能は遺伝発現解析に欠かせない\cite{farhadifar2007influence}．

またscRNA-seqにおいて細胞を単離させる方法はいくつかあり\cite{kolodziejczyk2015technology}，マイクロロボットツールによって一つずつ細胞を集めてくる手法であれば，上記の一細胞レベルの空間分解能を保持することが可能である．しかしながらマイクロロボットツールを用いた手法は，その手作業による多大な労力と一時間に数細胞程度という低スループットにより，現実的ではない．また前述したシロイヌナズナの研究のように，遺伝子発現解析では統計的推定の効果を得るために大量の細胞を取得することが望まれる．

\begin{figure}[t]
    \centering
    \begin{subfigure}[t]{0.27\linewidth}
        \centering
        \includegraphics[width=\linewidth]{fig/protoplast_image.pdf}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.67\linewidth}
        \centering
        \includegraphics[width=\linewidth]{fig/moonshot_system.pdf}
    \end{subfigure}
    \caption[プロトプラスト化した細胞と位置情報付き一細胞分取システム]{プロトプラスト化した細胞と位置情報付き一細胞分取システム．（左）丸く見えるものがプロトプラスト化した細胞であり，シロイヌナズナの根から遊離している．（右）システムは顕微鏡，AIを組み込んだシステム，マイクロロボットツールの三つから構成される．}
    \label{fig:protoplast_and_main_system}
\end{figure}

そこでわれわれはムーンショット型研究開発プロジェクト目標3「人とAIロボットの創造的共進化によるサイエンス開拓」\cite{moonshotHarada}において，シロイヌナズナの根を対象とした，人工知能（AI）とマイクロロボット\cite{ando2024single}を用いた位置情報付き一細胞分取システムの構築に取り組んでいる（図\ref{fig:protoplast_and_main_system}（右）参照）．このシステムではまず，酵素処理によって単離させた細胞の挙動を顕微鏡で連続的に撮影する．そしてその画像を人工知能を組み込んだシステムに入力し，細胞の位置情報をマイクロロボットツールに送る．そしてマイクロロボットツールをその場所に向かわせ，細胞を一つずつ収集する．また人工知能（AI）を組み込んだシステムでは，細胞の位置情報を捕捉するだけでなく，単離する前の細胞の位置情報を特定する．これにより，一細胞レベルの空間分解能を持ったscRNA-seqを可能にする．

\section{本研究の貢献}
\label{sec:contribution}

単離する前の細胞の位置情報保持とマイクロロボットツールで細胞を収集するための位置情報送信は，すべての細胞を追跡すれば達成することができる．追跡時に各時刻における細胞の位置を保存しておき，細胞を収集した後にその細胞がどこから単離した細胞であるのかを確認すればよい．よってAIを組み込んだシステムの役割は，連続的に撮影された画像データを用いてリアルタイムに単離した細胞を追跡し，マイクロロボットツールにその位置情報を送りつつ，同時にその追跡した軌跡を保存しておくことである．

酵素溶液によって単離した細胞は，流体環境にさらされているため，三次元空間を遊離する．そのためすべての細胞を追跡するためには，三次元空間を認識できる顕微鏡を用いなければならない．そこでわれわれのシステムでは共焦点顕微鏡という特別な顕微鏡を用いることで，複数の焦点面でスライスされた複数の二次元画像により三次元空間を捉える．詳細については後述の\ref{sec:ai_system}節を参照されたい．

一方，画像の時系列データを入力として物体の追跡を行うタスクは，複数物体追跡（Multi Object Tracking,\ MOT）と呼ばれ，自動車の自動運転やロボット操作などに利用されている．一般的なMOTでは，単一の二次元画像の時系列データを入力としている．そして各画像における物体を位置$(x, y)$，幅$w$，高さ$h$で構成されるバウンディングボックスと呼ばれる矩形で捉え，このバウンディングボックスに個体を識別するためのIDを振ることで追跡が行われる．

しかし本研究では，酵素溶液中の細胞の追跡，すなわち三次元空間での追跡を行いたいため，既存の単一二次元画像に対するMOT手法でこれを達成できるかは自明ではない．本研究では共焦点顕微鏡を用いているため，焦点面の中での追跡であれば焦点面ごとで既存のMOT手法を適用するだけでも可能ではあるが，異なる焦点面へ移動する細胞の移動を高精度に捉えることは難しい．

そこで本研究ではまず，DepthSORTという処理を提案し，各焦点面から得られる複数の二次元画像の時系列データに対応したIDの割り振りを行う．前述の単一二次元画像に対応した既存の手法のみでは，他の焦点面画像に映る同一個体由来のバウンディングボックスに，共通のIDを振ることができない．そこでDepthSORTは焦点面方向に物体の追跡を行うことで，焦点面を跨いだIDの割り振りを可能にする．

そして三次元的な座標やサイズを推定するために，SliceKalmanFilterと名付けるカルマンフィルタの設計を行う．このSliceKalmanFilterは，前述のDepthSORTから得られる，複数の焦点面におけるバウンディングボックスを観測変数とする．そしてこれを用いて，状態変数とする細胞の三次元的な座標およびサイズを推定する．このSliceKalmanFilterにより，最終的にマイクロロボットツールに送る細胞の情報や単離する前の位置を特定するための情報を推定することが可能になる．

本研究ではこれらの提案手法を用いることで，リアルタイムに入力される複数の共焦点画像から単離した細胞を追跡し，最新の位置およびそれまでの軌跡を特定するシステムの構築に成功した．またこのシステムを実際にマイクロロボットツールに組み込み，実際のシロイヌナズナの根から遊離するプロトプラスト化細胞に対して自動分取できることを確認した．

\section{本論文の構成}
\label{sec:outline}

本論文では，まずはじめに位置情報付き一細胞分取システムのAI部分の問題設定を詳細に述べ，定式化を行う（第\ref{chap:setting}章）．そしてMOTタスクでしばしば用いられるTracking-by-Detectionの枠組みとそれらの構成要素であるYOLO，カルマンフィルタ，ハンガリアンアルゴリズムについて説明する（\ref{sec:existing_method}節）．そしてそれらを本問題設定に適用するうえでの問題点を整理した後，提案するDepthSORTとSliceKalmanFilterについて詳細を述べる（\ref{sec:proposed_method}節）．そして計算機実験では，検証用データを対象にDepthSORTおよびSliceKalmanFilterの精度評価を行う（第\ref{chap:experiment}章）．